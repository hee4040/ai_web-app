-- =============================================================================
-- 변경 사유
-- =============================================================================
-- 태그별 검색 기능 추가를 위한 성능 최적화
-- posts.tags (text[]) 컬럼에 대한 GIN 인덱스 추가로,
-- @> (포함), && (교집합) 연산자 기반 태그 검색 쿼리 성능 향상
--
-- 예시 쿼리:
--   WHERE tags @> ARRAY['Ubuntu']           -- 특정 태그 포함
--   WHERE tags && ARRAY['Git', 'macOS']     -- 여러 태그 중 하나라도 포함
--
-- =============================================================================
-- 영향도 평가
-- =============================================================================
-- ✅ 기존 데이터: 영향 없음 (인덱스만 추가)
-- ✅ 기존 쿼리: 영향 없음 (SELECT 성능만 향상)
-- ✅ INSERT/UPDATE: 약간의 오버헤드 (인덱스 유지 비용, 미미함)
-- ✅ 스토리지: 인덱스 크기 증가 (tags 배열 크기에 비례, 일반적으로 작음)
-- ✅ RLS: 영향 없음
--
-- =============================================================================
-- Rollback 구문
-- =============================================================================
-- 문제 발생 시 즉시 원복:
--   DROP INDEX IF EXISTS public.idx_posts_tags_gin;
--
-- =============================================================================

-- GIN 인덱스 추가 (tags 배열 검색 최적화)
CREATE INDEX IF NOT EXISTS idx_posts_tags_gin ON public.posts USING GIN(tags);
